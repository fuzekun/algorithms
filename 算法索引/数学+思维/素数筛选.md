## 素数筛选



线性筛选: 保证只使用最小的筛选所有合数, 并且，保证所有的合数可以被筛选出来。 

1. primes[j]是t = i * primes[j]的最小素数因子。
   - 如果i % primes[j] != 0, 那么t % primes[k] (k < j)，因为i中的素数因子不包含primes[k]，并且primes[j]与primes[k]互素。
   - 如果i % primes[j] == 0， 那么primes[j]一定是t的最小素数因子。

2. 所有的合数一定会被筛选出来。
   - 如果i是合数，那么一定可以在i / primes[j]处筛选出来，其中primes[j]就是i的最小质因子。



> 举个例子
>
> 在i = 4的时候，可以筛选出来8，不能筛选出来12。为什么呢？因为4不是12的最小质因子，2才是12的最小质因子。那么i = 6的时候就可以用2 * 6把12筛选出来。

```cpp

st[maxn];		// 不是素数是集合
vector<int>primes;
for (int i = 2; i <= n; i++) {
    if (!st[i]) primes.push_back(i);
    for (int j = 0; primes[j] <= n / i; j++) {  // 保证primes[j] * i <= n
        st[i * primes[j]] = 1;					
        if (i % primes[j] == 0) break;         // 保证primes[j]是t的最小质因子
    }
}
```

